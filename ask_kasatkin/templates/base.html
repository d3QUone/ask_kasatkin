<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="utf-8">
<meta name="description" content="Сайт с ответами на любые вопросы. Русский конкурент Stackoverflow">
<meta name="keywords" content="stackoverflow, python, django, ask, kasatkin, techopark, mail.ru, mail.ru group, mailru, mailru group, технопарк, мэйл.ру, мэйл.ру груп">
<title>{% block title %}{% endblock title %}</title>
<link rel="stylesheet" href="/static/css/bootstrap.min.css">
<link rel="stylesheet" href="/static/css/improve.css">
</head>
<body>
<nav class="navbar navbar-default navbar-static-top navbar__new__color">
    <div class="navbar__base__block">

        <a href="{% url 'core:home' %}"><h4>Ask.Kasatkin</h4></a>
        
        <form method="GET" action="#">
            <input name="request" type="search" class="form-control h__input__field" placeholder="Find something">
        </form>

        <a href="{% if user.is_authenticated %}{% url 'core:create_question' %}{% else %}{% url 'user_profile:login' %}{% endif %}" class="btn button__styled">Ask</a>

        {% if user.is_authenticated %}
            <div class="col-xs-3 no__paddings">
                <img class="img-rounded navbar__avatar" src="{{ MEDIA_URL }}{{ personal.avatar }}"><br>
            </div>
            <div class="col-xs-9 no__paddings">
                {{ personal.nickname }}<br>
                <a href="{% url 'user_profile:settings' %}">Settings</a>
                &nbsp;
                <a href="{% url 'user_profile:logout' %}">Log out</a>
            </div>
        {% else %}
            <a href="{% url 'user_profile:register' %}" class="btn btn-primary">Register</a>
            &nbsp;
            <a href="{% url 'user_profile:login' %}"class="btn btn-primary">Log in</a>
        {% endif %}

    </div>

    <!--div class="container">
        <div class="row-fluid">

            <div class="col-xs-2 navbar__low">
                <a href="{% url 'core:home' %}"><h4>Ask.Kasatkin</h4></a>
            </div>

            <div class="col-xs-8 navbar__high">
                <form method="GET" action="#">
                    <input name="request" type="search" class="form-control navbar__input__form" placeholder="Find something">
                </form>

                {% if user.is_authenticated %}
                    <a href="{% url 'core:create_question' %}" class="btn button__styled">Ask</a>
                {% else %}
                    <a href="{% url 'user_profile:login' %}" class="btn button__styled">Ask</a>
                {% endif %}
            </div>

            <div class="col-xs-2 navbar__high">
                <div class="container-fluid">
                {% if user.is_authenticated %}
                    <div class="col-xs-3">
                        <img class="img-rounded navbar__avatar" src="{{ MEDIA_URL }}{{ personal.avatar }}"><br>
                    </div>
                    <div class="col-xs-9">
                        {{ personal.nickname }}<br>
                        <a href="{% url 'user_profile:settings' %}">Settings</a>
                        &nbsp;
                        <a href="{% url 'user_profile:logout' %}">Log out</a>
                    </div>
                {% else %}
                    <a href="{% url 'user_profile:register' %}" class="btn btn-primary">Register</a>
                    &nbsp;
                    <a href="{% url 'user_profile:login' %}"class="btn btn-primary">Log in</a>
                {% endif %}
                </div>
            </div>

        </div>
    </div-->

</nav>
<!-- container for our content -->
<div class="container-fixed">
    <div class="row-fluid">
        <div class="col-xs-2"></div>
        <div class="col-xs-8">
            <!-- LEFT COLUMN: questions / add answer / add question / etc. -->
            {% block content %}{% endblock content %}
        </div>
        <div class="col-xs-2 column__left__fix">
            <!-- RIGHT COLUMN: (tags + best members), same in all cases -->
            <h4>Popular Tags:</h4>
            {% for tag in popular_tags %}<a href="{% url 'core:all_by_tag' tag.text %}"><span class="{{ tag.label }} tag__margin">{{ tag.text }}</span></a>
            {% endfor %}
            <br>
            <hr>
            {% if popular_users %}
                <h4>Best Members:</h4>
                {% for pop_user in popular_users %}<p><span class="underline__link">{{ pop_user }}</span></p>
                {%  endfor %}
            {% else %}
                <p>No best members yet</p>
            {% endif %}
        </div>
    </div>
</div>
<script src="/static/js/jquery.min.js"></script>
<script src="/static/js/bootstrap.min.js"></script>
{% block scripts %}{% endblock scripts %}
{% block jq_likes %}
<!-- will override this method ob page I dont need it -->
<script type="text/javascript">

//// QUESTIONS /////

$("span.question_like").click(function(){
  var pid = $(this).attr('id');
  $.post("{% url 'core:like_question' %}", 
    {
      pid: pid, 
      like: 1
    }, 
    update_rating
  );
  function update_rating(result){
    if (result != "None") {
      $("div#" + pid).html("Rating: " + result);
    }
  }
});

$("span.question_dislike").click(function(){
  var pid = $(this).attr('id');
  $.post("{% url 'core:like_question' %}", 
    {
      pid: pid, 
      like: 0
    }, 
    update_rating
  );
  function update_rating(result){
    if (result != "None") {
      $("div#" + pid).html("Rating: " + result);
    }
  }
});


///// ANSWERS //////

$("span.ans_like").click(function(){
  var aid = $(this).attr('id');
  $.post("{% url 'core:like_answer' %}", 
    {
      aid: aid, 
      like: 1
    }, 
    update_rating
  );
  function update_rating(result){
    if (result != "None") {
      $("div#" + aid).html("Rating: " + result);
    }
  }
});

$("span.ans_dislike").click(function(){
  var aid = $(this).attr('id');
  $.post("{% url 'core:like_answer' %}", 
    {
      aid: aid, 
      like: 0
    }, 
    update_rating
  );
  function update_rating(result){
    if (result != "None") {
      $("div#" + aid).html("Rating: " + result);
    }
  }
});

</script>
{% endblock jq_likes %}
<script type="text/javascript">
    (function (d, w, c) {
     (w[c] = w[c] || []).push(function() {
                              try {
                              w.yaCounter28737341 = new Ya.Metrika({id:28737341,
                                                                   webvisor:true,
                                                                   clickmap:true,
                                                                   trackLinks:true,
                                                                   accurateTrackBounce:true});
                              } catch(e) { }
                              });
     var n = d.getElementsByTagName("script")[0],
     s = d.createElement("script"),
     f = function () { n.parentNode.insertBefore(s, n); };
     s.type = "text/javascript";
     s.async = true;
     s.src = (d.location.protocol == "https:" ? "https:" : "http:") + "//mc.yandex.ru/metrika/watch.js";
     if (w.opera == "[object Opera]") {
     d.addEventListener("DOMContentLoaded", f, false);
     } else { f(); }
     })(document, window, "yandex_metrika_callbacks");
    </script>
<noscript><div><img src="//mc.yandex.ru/watch/28737341" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
</body>
</html>
